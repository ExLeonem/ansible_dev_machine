- hosts: localhost
  become: true
  tasks:
   - name: Install zsh
     apt:
      name: {{items}}
     loop:
      - zsh
      - git
      - curl
      - docker.io

   - name: create default folder structure
     file:
      path: "{{ item }}"
      state: directory
     loop:
      - '/home/{{lookup("env", "USER")}}/Desktop/projects'
      - '/home/{{lookup("env", "USER")}}/Desktop/studium'

   - name: set zsh as default shell
     become_user: root
     shell: |
      chsh -s /bin/zsh
     
   - name: install vs-code
     become_user: root
     shell: |
      curl https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor > packages.microsoft.gpg     
      install -o root -g root -m 644 packages.microsoft.gpg /usr/share/keyrings/
      sh -c 'echo "deb [arch=amd64 signed-by=/usr/share/keyrings/packages.microsoft.gpg] https://packages.microsoft.com/repos/vscode stable main" > /etc/apt/sources.list.d/vscode.list'
      apt-get install apt-transport-https
      apt-get update
      apt-get install code

   - name: install .asdf
     shell: |
      git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.7.8
      echo -e '. $HOME/.asdf/asdf.sh' >> ~/.zshrc

   - name: enable docker to run services at startup 
     become_user: root
     shell: |
      systemctl start docker
      systemctl enable docker
